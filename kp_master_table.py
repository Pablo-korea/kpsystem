"""
KP시스템 마스터 테이블 데이터
각 도수 범위에 대한 정확한 Sign Lord, Nakshatra Lord, Sub Lord 정보
이미지 기반 정확한 데이터
"""

# 마스터 테이블 데이터 (도수 범위별 Lord 정보)
# 형식: (시작도수, 끝도수, Sign_Lord, Nakshatra_Lord, Sub_Lord)
MASTER_TABLE = [
    (0.0, 0.777778, "Ma", "Ke", "Ke"),
    (0.777778, 3.0, "Ma", "Ke", "Ve"),
    (3.0, 3.666667, "Ma", "Ke", "Su"),
    (3.666667, 4.777778, "Ma", "Ke", "Mo"),
    (4.777778, 5.555556, "Ma", "Ke", "Ma"),
    (5.555556, 7.555556, "Ma", "Ke", "Ra"),
    (7.555556, 9.333333, "Ma", "Ke", "Ju"),
    (9.333333, 11.444444, "Ma", "Ke", "Sa"),
    (11.444444, 13.333333, "Ma", "Ke", "Me"),
    (13.333333, 15.555556, "Ma", "Ve", "Ve"),
    (15.555556, 16.222222, "Ma", "Ve", "Su"),
    (16.222222, 17.333333, "Ma", "Ve", "Mo"),
    (17.333333, 18.111111, "Ma", "Ve", "Ma"),
    (18.111111, 20.111111, "Ma", "Ve", "Ra"),
    (20.111111, 21.888889, "Ma", "Ve", "Ju"),
    (21.888889, 24.0, "Ma", "Ve", "Sa"),
    (24.0, 25.888889, "Ma", "Ve", "Me"),
    (25.888889, 26.666667, "Ma", "Ve", "Ke"),
    (26.666667, 27.333333, "Ma", "Su", "Su"),
    (27.333333, 28.444444, "Ma", "Su", "Mo"),
    (28.444444, 29.222222, "Ma", "Su", "Ma"),
    (29.222222, 30.0, "Ma", "Su", "Ra"),
    (30.0, 31.222222, "Ve", "Su", "Ra"),
    (31.222222, 33.0, "Ve", "Su", "Ju"),
    (33.0, 35.111111, "Ve", "Su", "Sa"),
    (35.111111, 37.0, "Ve", "Su", "Me"),
    (37.0, 37.777778, "Ve", "Su", "Ke"),
    (37.777778, 40.0, "Ve", "Su", "Ve"),
    (40.0, 41.111111, "Ve", "Mo", "Mo"),
    (41.111111, 41.888889, "Ve", "Mo", "Ma"),
    (41.888889, 43.888889, "Ve", "Mo", "Ra"),
    (43.888889, 45.666667, "Ve", "Mo", "Ju"),
    (45.666667, 47.777778, "Ve", "Mo", "Sa"),
    (47.777778, 49.666667, "Ve", "Mo", "Me"),
    (49.666667, 50.444444, "Ve", "Mo", "Ke"),
    (50.444444, 52.666667, "Ve", "Mo", "Ve"),
    (52.666667, 53.333333, "Ve", "Mo", "Su"),
    (53.333333, 54.111111, "Ve", "Ma", "Ma"),
    (54.111111, 56.111111, "Ve", "Ma", "Ra"),
    (56.111111, 57.888889, "Ve", "Ma", "Ju"),
    (57.888889, 60.0, "Ve", "Ma", "Sa"),
    (60.0, 61.888889, "Me", "Ma", "Me"),
    (61.888889, 62.666667, "Me", "Ma", "Ke"),
    (62.666667, 64.888889, "Me", "Ma", "Ve"),
    (64.888889, 65.555556, "Me", "Ma", "Su"),
    (65.555556, 66.666667, "Me", "Ma", "Mo"),
    (66.666667, 68.666667, "Me", "Ra", "Ra"),
    (68.666667, 70.444444, "Me", "Ra", "Ju"),
    (70.444444, 72.555556, "Me", "Ra", "Sa"),
    (72.555556, 74.444444, "Me", "Ra", "Me"),
    (74.444444, 75.222222, "Me", "Ra", "Ke"),
    (75.222222, 77.444444, "Me", "Ra", "Ve"),
    (77.444444, 78.111111, "Me", "Ra", "Su"),
    (78.111111, 79.222222, "Me", "Ra", "Mo"),
    (79.222222, 80.0, "Me", "Ra", "Ma"),
    (80.0, 81.777778, "Me", "Ju", "Ju"),
    (81.777778, 83.888889, "Me", "Ju", "Sa"),
    (83.888889, 85.777778, "Me", "Ju", "Me"),
    (85.777778, 86.555556, "Me", "Ju", "Ke"),
    (86.555556, 88.777778, "Me", "Ju", "Ve"),
    (88.777778, 89.444444, "Me", "Ju", "Su"),
    (89.444444, 90.0, "Me", "Ju", "Mo"),
    (90.0, 90.555556, "Mo", "Ju", "Mo"),
    (90.555556, 91.333333, "Mo", "Ju", "Ma"),
    (91.333333, 93.333333, "Mo", "Ju", "Ra"),
    (93.333333, 95.444444, "Mo", "Sa", "Sa"),
    (95.444444, 97.333333, "Mo", "Sa", "Me"),
    (97.333333, 98.111111, "Mo", "Sa", "Ke"),
    (98.111111, 100.333333, "Mo", "Sa", "Ve"),
    (100.333333, 101.0, "Mo", "Sa", "Su"),
    (101.0, 102.111111, "Mo", "Sa", "Mo"),
    (102.111111, 102.888889, "Mo", "Sa", "Ma"),
    (102.888889, 104.888889, "Mo", "Sa", "Ra"),
    (104.888889, 106.666667, "Mo", "Sa", "Ju"),
    (106.666667, 108.555556, "Mo", "Me", "Me"),
    (108.555556, 109.333333, "Mo", "Me", "Ke"),
    (109.333333, 111.555556, "Mo", "Me", "Ve"),
    (111.555556, 112.222222, "Mo", "Me", "Su"),
    (112.222222, 113.333333, "Mo", "Me", "Mo"),
    (113.333333, 114.111111, "Mo", "Me", "Ma"),
    (114.111111, 116.111111, "Mo", "Me", "Ra"),
    (116.111111, 117.888889, "Mo", "Me", "Ju"),
    (117.888889, 120.0, "Mo", "Me", "Sa"),
    (120.0, 120.777778, "Su", "Ke", "Ke"),
    (120.777778, 123.0, "Su", "Ke", "Ve"),
    (123.0, 123.666667, "Su", "Ke", "Su"),
    (123.666667, 124.777778, "Su", "Ke", "Mo"),
    (124.777778, 125.555556, "Su", "Ke", "Ma"),
    (125.555556, 127.555556, "Su", "Ke", "Ra"),
    (127.555556, 129.333333, "Su", "Ke", "Ju"),
    (129.333333, 131.444444, "Su", "Ke", "Sa"),
    (131.444444, 133.333333, "Su", "Ke", "Me"),
    (133.333333, 135.555556, "Su", "Ve", "Ve"),
    (135.555556, 136.222222, "Su", "Ve", "Su"),
    (136.222222, 137.333333, "Su", "Ve", "Mo"),
    (137.333333, 138.111111, "Su", "Ve", "Ma"),
    (138.111111, 140.111111, "Su", "Ve", "Ra"),
    (140.111111, 141.888889, "Su", "Ve", "Ju"),
    (141.888889, 144.0, "Su", "Ve", "Sa"),
    (144.0, 145.888889, "Su", "Ve", "Me"),
    (145.888889, 146.666667, "Su", "Ve", "Ke"),
    (146.666667, 147.333333, "Su", "Su", "Su"),
    (147.333333, 148.444444, "Su", "Su", "Mo"),
    (148.444444, 149.222222, "Su", "Su", "Ma"),
    (149.222222, 150.0, "Su", "Su", "Ra"),
    (150.0, 151.222222, "Me", "Su", "Ra"),
    (151.222222, 153.0, "Me", "Su", "Ju"),
    (153.0, 155.111111, "Me", "Su", "Sa"),
    (155.111111, 157.0, "Me", "Su", "Me"),
    (157.0, 157.777778, "Me", "Su", "Ke"),
    (157.777778, 160.0, "Me", "Su", "Ve"),
    (160.0, 161.111111, "Me", "Mo", "Mo"),
    (161.111111, 161.888889, "Me", "Mo", "Ma"),
    (161.888889, 163.888889, "Me", "Mo", "Ra"),
    (163.888889, 165.666667, "Me", "Mo", "Ju"),
    (165.666667, 167.777778, "Me", "Mo", "Sa"),
    (167.777778, 169.666667, "Me", "Mo", "Me"),
    (169.666667, 170.444444, "Me", "Mo", "Ke"),
    (170.444444, 172.666667, "Me", "Mo", "Ve"),
    (172.666667, 173.333333, "Me", "Mo", "Su"),
    (173.333333, 174.111111, "Me", "Ma", "Ma"),
    (174.111111, 176.111111, "Me", "Ma", "Ra"),
    (176.111111, 177.888889, "Me", "Ma", "Ju"),
    (177.888889, 180.0, "Me", "Ma", "Sa"),
    (180.0, 181.888889, "Ve", "Ma", "Me"),
    (181.888889, 182.666667, "Ve", "Ma", "Ke"),
    (182.666667, 184.888889, "Ve", "Ma", "Ve"),
    (184.888889, 185.555556, "Ve", "Ma", "Su"),
    (185.555556, 186.666667, "Ve", "Ma", "Mo"),
    (186.666667, 188.666667, "Ve", "Ra", "Ra"),
    (188.666667, 190.444444, "Ve", "Ra", "Ju"),
    (190.444444, 192.555556, "Ve", "Ra", "Sa"),
    (192.555556, 194.444444, "Ve", "Ra", "Me"),
    (194.444444, 195.222222, "Ve", "Ra", "Ke"),
    (195.222222, 197.444444, "Ve", "Ra", "Ve"),
    (197.444444, 198.111111, "Ve", "Ra", "Su"),
    (198.111111, 199.222222, "Ve", "Ra", "Mo"),
    (199.222222, 200.0, "Ve", "Ra", "Ma"),
    (200.0, 201.777778, "Ve", "Ju", "Ju"),
    (201.777778, 203.888889, "Ve", "Ju", "Sa"),
    (203.888889, 205.777778, "Ve", "Ju", "Me"),
    (205.777778, 206.555556, "Ve", "Ju", "Ke"),
    (206.555556, 208.777778, "Ve", "Ju", "Ve"),
    (208.777778, 209.444444, "Ve", "Ju", "Su"),
    (209.444444, 210.0, "Ve", "Ju", "Mo"),
    (210.0, 210.555556, "Ma", "Ju", "Mo"),
    (210.555556, 211.333333, "Ma", "Ju", "Ma"),
    (211.333333, 213.333333, "Ma", "Ju", "Ra"),
    (213.333333, 215.444444, "Ma", "Sa", "Sa"),
    (215.444444, 217.333333, "Ma", "Sa", "Me"),
    (217.333333, 218.111111, "Ma", "Sa", "Ke"),
    (218.111111, 220.333333, "Ma", "Sa", "Ve"),
    (220.333333, 221.0, "Ma", "Sa", "Su"),
    (221.0, 222.111111, "Ma", "Sa", "Mo"),
    (222.111111, 222.888889, "Ma", "Sa", "Ma"),
    (222.888889, 224.888889, "Ma", "Sa", "Ra"),
    (224.888889, 226.666667, "Ma", "Sa", "Ju"),
    (226.666667, 228.555556, "Ma", "Me", "Me"),
    (228.555556, 229.333333, "Ma", "Me", "Ke"),
    (229.333333, 231.555556, "Ma", "Me", "Ve"),
    (231.555556, 232.222222, "Ma", "Me", "Su"),
    (232.222222, 233.333333, "Ma", "Me", "Mo"),
    (233.333333, 234.111111, "Ma", "Me", "Ma"),
    (234.111111, 236.111111, "Ma", "Me", "Ra"),
    (236.111111, 237.888889, "Ma", "Me", "Ju"),
    (237.888889, 240.0, "Ma", "Me", "Sa"),
    (240.0, 240.777778, "Ju", "Ke", "Ke"),
    (240.777778, 243.0, "Ju", "Ke", "Ve"),
    (243.0, 243.666667, "Ju", "Ke", "Su"),
    (243.666667, 244.777778, "Ju", "Ke", "Mo"),
    (244.777778, 245.555556, "Ju", "Ke", "Ma"),
    (245.555556, 247.555556, "Ju", "Ke", "Ra"),
    (247.555556, 249.333333, "Ju", "Ke", "Ju"),
    (249.333333, 251.444444, "Ju", "Ke", "Sa"),
    (251.444444, 253.333333, "Ju", "Ke", "Me"),
    (253.333333, 255.555556, "Ju", "Ve", "Ve"),
    (255.555556, 256.222222, "Ju", "Ve", "Su"),
    (256.222222, 257.333333, "Ju", "Ve", "Mo"),
    (257.333333, 258.111111, "Ju", "Ve", "Ma"),
    (258.111111, 260.111111, "Ju", "Ve", "Ra"),
    (260.111111, 261.888889, "Ju", "Ve", "Ju"),
    (261.888889, 264.0, "Ju", "Ve", "Sa"),
    (264.0, 265.888889, "Ju", "Ve", "Me"),
    (265.888889, 266.666667, "Ju", "Ve", "Ke"),
    (266.666667, 267.333333, "Ju", "Su", "Su"),
    (267.333333, 268.444444, "Ju", "Su", "Mo"),
    (268.444444, 269.222222, "Ju", "Su", "Ma"),
    (269.222222, 270.0, "Ju", "Su", "Ra"),
    (270.0, 271.222222, "Sa", "Su", "Ra"),
    (271.222222, 273.0, "Sa", "Su", "Ju"),
    (273.0, 275.111111, "Sa", "Su", "Sa"),
    (275.111111, 277.0, "Sa", "Su", "Me"),
    (277.0, 277.777778, "Sa", "Su", "Ke"),
    (277.777778, 280.0, "Sa", "Su", "Ve"),
    (280.0, 281.111111, "Sa", "Mo", "Mo"),
    (281.111111, 281.888889, "Sa", "Mo", "Ma"),
    (281.888889, 283.888889, "Sa", "Mo", "Ra"),
    (283.888889, 285.666667, "Sa", "Mo", "Ju"),
    (285.666667, 287.777778, "Sa", "Mo", "Sa"),
    (287.777778, 289.666667, "Sa", "Mo", "Me"),
    (289.666667, 290.444444, "Sa", "Mo", "Ke"),
    (290.444444, 292.666667, "Sa", "Mo", "Ve"),
    (292.666667, 293.333333, "Sa", "Mo", "Su"),
    (293.333333, 294.111111, "Sa", "Ma", "Ma"),
    (294.111111, 296.111111, "Sa", "Ma", "Ra"),
    (296.111111, 297.888889, "Sa", "Ma", "Ju"),
    (297.888889, 300.0, "Sa", "Ma", "Sa"),
    (300.0, 301.888889, "Sa", "Ma", "Me"),
    (301.888889, 302.666667, "Sa", "Ma", "Ke"),
    (302.666667, 304.888889, "Sa", "Ma", "Ve"),
    (304.888889, 305.555556, "Sa", "Ma", "Su"),
    (305.555556, 306.666667, "Sa", "Ma", "Mo"),
    (306.666667, 308.666667, "Sa", "Ra", "Ra"),
    (308.666667, 310.444444, "Sa", "Ra", "Ju"),
    (310.444444, 312.555556, "Sa", "Ra", "Sa"),
    (312.555556, 314.444444, "Sa", "Ra", "Me"),
    (314.444444, 315.222222, "Sa", "Ra", "Ke"),
    (315.222222, 317.444444, "Sa", "Ra", "Ve"),
    (317.444444, 318.111111, "Sa", "Ra", "Su"),
    (318.111111, 319.222222, "Sa", "Ra", "Mo"),
    (319.222222, 320.0, "Sa", "Ra", "Ma"),
    (320.0, 321.777778, "Sa", "Ju", "Ju"),
    (321.777778, 323.888889, "Sa", "Ju", "Sa"),
    (323.888889, 325.777778, "Sa", "Ju", "Me"),
    (325.777778, 326.555556, "Sa", "Ju", "Ke"),
    (326.555556, 328.777778, "Sa", "Ju", "Ve"),
    (328.777778, 329.444444, "Sa", "Ju", "Su"),
    (329.444444, 330.0, "Sa", "Ju", "Mo"),
    (330.0, 330.555556, "Ju", "Ju", "Mo"),
    (330.555556, 331.333333, "Ju", "Ju", "Ma"),
    (331.333333, 333.333333, "Ju", "Ju", "Ra"),
    (333.333333, 335.444444, "Ju", "Sa", "Sa"),
    (335.444444, 337.333333, "Ju", "Sa", "Me"),
    (337.333333, 338.111111, "Ju", "Sa", "Ke"),
    (338.111111, 340.333333, "Ju", "Sa", "Ve"),
    (340.333333, 341.0, "Ju", "Sa", "Su"),
    (341.0, 342.111111, "Ju", "Sa", "Mo"),
    (342.111111, 342.888889, "Ju", "Sa", "Ma"),
    (342.888889, 344.888889, "Ju", "Sa", "Ra"),
    (344.888889, 346.666667, "Ju", "Sa", "Ju"),
    (346.666667, 348.555556, "Ju", "Me", "Me"),
    (348.555556, 349.333333, "Ju", "Me", "Ke"),
    (349.333333, 351.555556, "Ju", "Me", "Ve"),
    (351.555556, 352.222222, "Ju", "Me", "Su"),
    (352.222222, 353.333333, "Ju", "Me", "Mo"),
    (353.333333, 354.111111, "Ju", "Me", "Ma"),
    (354.111111, 356.111111, "Ju", "Me", "Ra"),
    (356.111111, 357.888889, "Ju", "Me", "Ju"),
    (357.888889, 360.0, "Ju", "Me", "Sa"),
]

def get_lords_from_master_table(degree):
    """
    주어진 도수에 해당하는 Sign Lord, Nakshatra Lord, Sub Lord를 반환
    
    Args:
        degree (float): 도수 (0.0 ~ 360.0)
    
    Returns:
        tuple: (Sign_Lord, Nakshatra_Lord, Sub_Lord)
    """
    # 입력값 검증 및 안전한 변환
    if degree is None:
        degree = 0.0
    try:
        degree = float(degree)
    except (ValueError, TypeError):
        degree = 0.0
    
    # 도수를 0-360 범위로 정규화
    degree = degree % 360.0
    
    # 마스터 테이블에서 해당 도수 범위 찾기
    for start_deg, end_deg, sl, nl, sr in MASTER_TABLE:
        if start_deg <= degree < end_deg:
            return sl, nl, sr
    
    # 기본값 반환 (찾지 못한 경우)
    return "Mo", "Ke", "Su"

def get_sign_lord(degree):
    """Sign Lord 반환"""
    sl, _, _ = get_lords_from_master_table(degree)
    return sl

def get_nakshatra_lord(degree):
    """Nakshatra Lord 반환"""
    _, nl, _ = get_lords_from_master_table(degree)
    return nl

def get_sub_lord(degree):
    """Sub Lord 반환"""
    _, _, sr = get_lords_from_master_table(degree)
    return sr

# 테스트 함수
def test_master_table():
    """마스터 테이블 테스트"""
    print("=== KP 마스터 테이블 테스트 (0°-30°) ===")
    
    test_degrees = [0.0, 0.5, 1.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0]
    
    for deg in test_degrees:
        sl, nl, sr = get_lords_from_master_table(deg)
        print(f"{deg:6.1f}°: SL={sl}, NL={nl}, SR={sr}")

if __name__ == "__main__":
    test_master_table() 